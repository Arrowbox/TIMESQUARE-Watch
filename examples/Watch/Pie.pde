PROGMEM uint8_t
 wedge[] = {
  0x1E,0x12,0x02,0x00,0x66,0x12,0x02,0x00,0xBF,0x12,0x02,0x00,0xF9,0x25,0x02,0x00,
  0xF9,0x62,0x02,0x00,0xF6,0x9C,0x02,0x00,0xF9,0xAD,0x10,0x00,0xF9,0xAD,0x18,0x00,
  0xF9,0xAD,0x18,0x00,0xF7,0xAA,0x17,0x00,0xF6,0xA7,0x17,0x00,0xF3,0xA9,0x19,0x00,
  0xFC,0xAD,0x19,0x00,0xFC,0xAD,0x1B,0x00,0xFA,0xAD,0x19,0x00,0xF9,0xAD,0x1A,0x00,
  0x1E,0x1E,0x1D,0x02,0x50,0x1E,0x1D,0x02,0x8C,0x1E,0x1D,0x02,0xD5,0x1E,0x1D,0x02,
  0xFF,0x38,0x1D,0x02,0xFF,0x7A,0x1D,0x02,0xFF,0xD1,0x22,0x02,0xFF,0xFD,0x54,0x02,
  0xFF,0xFF,0xB1,0x02,0xFF,0xFF,0xEB,0x0A,0xFF,0xFF,0xF0,0x17,0xFF,0xFF,0xF4,0x1A,
  0xFF,0xFF,0xF3,0x18,0xFF,0xFF,0xF4,0x1A,0xFF,0xFF,0xF1,0x18,0xFF,0xFF,0xF4,0x1A,
  0x1E,0x1E,0x1E,0x12,0x3D,0x1E,0x1E,0x12,0x5D,0x1E,0x1E,0x12,0x84,0x1E,0x1E,0x12,
  0xB1,0x1E,0x1E,0x12,0xDE,0x24,0x1E,0x12,0xF7,0x3B,0x1E,0x12,0xFF,0x69,0x1E,0x12,
  0xFF,0xAB,0x24,0x12,0xFF,0xE1,0x48,0x12,0xFF,0xFD,0x95,0x1E,0xFF,0xFF,0xE5,0x4F,
  0xFF,0xFF,0xFF,0x96,0xFF,0xFF,0xFF,0xAD,0xFF,0xFF,0xFF,0xA9,0xFF,0xFF,0xFF,0xAD,
  0x1E,0x1E,0x1E,0x1E,0x2C,0x1E,0x1E,0x1E,0x35,0x1E,0x1E,0x1E,0x3E,0x1E,0x1E,0x1E,
  0x4C,0x1E,0x1E,0x1E,0x59,0x1E,0x1E,0x1E,0x69,0x1E,0x1E,0x1E,0x7E,0x1E,0x1E,0x1E,
  0x98,0x20,0x1E,0x1E,0xAB,0x29,0x1E,0x1E,0xBC,0x3D,0x1E,0x1E,0xCD,0x61,0x21,0x1E,
  0xDE,0x89,0x44,0x1F,0xEB,0xB2,0x7E,0x4D,0xF9,0xDE,0xC1,0x9A,0xFF,0xFF,0xFF,0xF9 },
 digits12[12][6] = { 
  { B00000000,
    B10110000,
    B10010000,
    B10100000,
    B10110000,
    B00000000 },
  { B01100000,
    B00100000,
    B00100000,
    B00100000,
    B00100000,
    B00100000 },
  { B01100000,
    B10010000,
    B00010000,
    B01100000,
    B10000000,
    B11110000 },
  { B11100000,
    B00010000,
    B01100000,
    B00010000,
    B10010000,
    B01100000 },
  { B10000000,
    B10100000,
    B10100000,
    B11110000,
    B00100000,
    B00100000 },
  { B11110000,
    B10000000,
    B11100000,
    B00010000,
    B10010000,
    B01100000 },
  { B01100000,
    B10000000,
    B11100000,
    B10010000,
    B10010000,
    B01100000 },
  { B11110000,
    B00010000,
    B00100000,
    B00100000,
    B01000000,
    B01000000 },
  { B01100000,
    B10010000,
    B01100000,
    B10010000,
    B10010000,
    B01100000 },
  { B01100000,
    B10010000,
    B10010000,
    B01110000,
    B00010000,
    B01100000 },
  { B00000000,
    B10111000,
    B10101000,
    B10101000,
    B10111000,
    B00000000 },
  { B00000000,
    B10010000,
    B10010000,
    B10010000,
    B10010000,
    B00000000 } },
 digits24[24][5] = {
  { B00000000,
    B11111100,
    B10110100,
    B10110100,
    B11111100 },
  { B00000000,
    B11101000,
    B10101000,
    B10101000,
    B11101000 },
  { B00000000,
    B11101100,
    B10100100,
    B10101000,
    B11101100 },
  { B00001100,
    B11100100,
    B10101100,
    B10100100,
    B11101100 },
  { B00000000,
    B11101000,
    B10101000,
    B10101100,
    B11100100 },
  { B00000000,
    B11101100,
    B10101000,
    B10100100,
    B11101100 },
  { B00000000,
    B11101100,
    B10101000,
    B10101100,
    B11101100 },
  { B00000000,
    B11101100,
    B10100100,
    B10100100,
    B11100100 },
  { B00000000,
    B11101100,
    B10101100,
    B10101100,
    B11101100 },
  { B00000000,
    B11101100,
    B10101100,
    B10100100,
    B11101100 },
  { B00000000,
    B01011100,
    B01010100,
    B01010100,
    B01011100 },
  { B00000000,
    B01001000,
    B01001000,
    B01001000,
    B01001000 },
  { B00000000,
    B01011000,
    B01001000,
    B01010000,
    B01011000 },
  { B00011000,
    B01001000,
    B01011000,
    B01001000,
    B01011000 },
  { B00000000,
    B01010000,
    B01010000,
    B01011000,
    B01001000 },
  { B00000000,
    B01011000,
    B01010000,
    B01001000,
    B01011000 },
  { B00000000,
    B01011000,
    B01010000,
    B01011000,
    B01011000 },
  { B00000000,
    B01011000,
    B01001000,
    B01001000,
    B01001000 },
  { B00000000,
    B01011000,
    B01011000,
    B01011000,
    B01011000 },
  { B00000000,
    B01011000,
    B01011000,
    B01001000,
    B01011000 },
  { B00000000,
    B11011100,
    B01010100,
    B10010100,
    B11011100 },
  { B00000000,
    B01101000,
    B00101000,
    B01001000,
    B01101000 },
  { B00000000,
    B11011000,
    B01001000,
    B10010000,
    B11011000 },
  { B00011000,
    B11001000,
    B01011000,
    B10001000,
    B11011000 } };

void mode_pie(uint8_t action) {
  DateTime now;
  uint8_t  h, m, i, q, w, b;
  uint16_t t;

  if(action != ACTION_NONE) {
    // If we just arrived here (whether through mode change
    // or wake from sleep), initialize the matrix driver:
    if(action >= ACTION_HOLD_LEFT) {
      depth = 4;
      fps   = watch.setDisplayMode(depth, LED_PLEX_2, true);
    }
    // Reset sleep timeout on ANY button action
    watch.setTimeout(fps * 3);
  }

  now = RTC.now();
  h   = now.hour();
  m   = now.minute();

  watch.fillScreen(BACKGROUND);
  b = ((t = watch.getTimeout()) < sizeof(fade)) ? (uint8_t)pgm_read_byte(&fade[t]) : 255;
  for(i=1, q=0; i<=4; i++, q += 15) {
    if(m <= q)             w = 0;
    else if(m >= (q + 15)) w = 15;
    else                   w = m - q;
    blit(wedge, 64, 4, w * 4, 0, 4, 0, 4, 4, b);
    watch.setRotation(i & 3);
  }

  if(h24) {
    watch.drawBitmap(1, 1, digits24[h], 6, 5, 0);
  } else {
    if(h >= 12) h -= 12;
    watch.drawBitmap(2, 1, digits12[h], 5, 6, 0);
  }
}

